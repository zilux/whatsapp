---
- name: Test hz.mes collection
  hosts: localhost
  gather_facts: false
  vars:
    text: " Ha die massa! ????? " 
    apikey: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          36613866613232373138616435333037323737366438306236663134626339363630343662353239
          3566623332373362643064376433333030323864613935640a663262666332346633636464373233
          38363737343232616636363935663662363962313135363637336461653034356663626664373063
          6364353966396639350a613530366636383436613336623136633664373230363761323638643733
          6330
    phone: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          61393337356530633839303433633535376238666662366664646437353630363036653837373136
          3038616363366164663833643862353132363562313763610a633836663765643036323639383361
          64363065373761376565336534306135353361363866666266373561626632383234316563366564
          3539373663313062390a373334383234653636633363363936633137656332346339646631613039
          6163      

  #  ANSIBLE_LIBRARY=./library ansible -m my_test -check -a 'apikey=3224312 phone=31619752112 message="Jus a test message ok"' localhost
  #
  tasks:

    - name: Send message to Watsup bot
      hz.mes.WhatsApp:
        text: "{{ text }}" 
        apikey: "{{ apikey }}"
        phone: "{{ phone }}"
      register: out
      # ignore_errors: true
      # failed_when: false
      # check_mode: true


    - debug: var=out

        
